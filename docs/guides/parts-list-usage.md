# パーツ一覧ページ利用ガイド

パーツ一覧ページは、AC6アセンブルツールで利用可能なパーツを横断的に探索するためのエントリポイントです。本ガイドでは、ページ内の主要機能と推奨される操作フローを説明します。

## 1. ページ構成概要

- **言語切替**: 画面右上の言語切替フォームで日本語/英語を切替えられます。切替時に`lng`クエリパラメータが保持されるため、URL共有時も選択言語が維持されます。
- **スロット選択**: 12種類のスロットをボタンで切替えます。折りたたみ制御により、モバイルサイズでも操作しやすい構成です。
- **フィルタパネル**: 属性・名前・メーカー・カテゴリの4種類のフィルタを複合的に設定できます。お気に入りのみ表示への切替もここで行います。
- **並び替えパネル**: スロットごとの有効属性から並び替え対象を選択し、昇順/降順を指定します。
- **パーツグリッド**: フィルタと並び替えが反映されたカード一覧です。結果0件時はEmptyStateが提示され、条件緩和のヒントを表示します。
- **アセン受け渡しボタン**: 現在の候補集合を組立ページへ渡すためのボタンです。候補0件のスロットがある場合は無効化され、対象スロット名を明示します。

## 2. 基本操作フロー

1. **スロットを選択**: 初期状態は`RIGHT ARM UNIT`が選択されています。別スロットへ切替えるとフィルタと候補が自動で更新されます。
2. **フィルタを追加**: フィルタ種類を選択し、条件を入力して「追加」を押下します。追加した条件はリストに表示され、×ボタンで削除できます。
3. **お気に入り絞り込み**: 星ボタンでお気に入りのみ表示に切替えたり解除したりできます。状態はURLパラメータとして保持されます。
4. **並び替えを適用**: 並び替え対象と順序を指定し「適用」を押下します。「クリア」で初期状態に戻せます。
5. **結果を確認**: グリッド下部に表示されるサマリで件数を把握し、カード上の星ボタンでお気に入り登録/解除が可能です。
6. **アセンへ渡す**: 条件が整ったら「アセンに渡す」を押下し、制限された候補集合を組立ページに適用します。

## 3. URLと状態同期

- **自動同期**: スロット、フィルタ、並び替え状態はクエリパラメータとして自動更新されます。`lng`を含む既存パラメータは保持されるため、URL共有で状態を再現できます。
- **圧縮保存**: フィルタ集合は`filters`パラメータに圧縮されたJSONで保存されます。手動編集は推奨されません。
- **LocalStorage利用**: 表示モードのみ`ac6-parts-list-view-mode`キーでLocalStorageに保持されます。フィルタや並び替えはURLベース管理です。

## 4. アクセシビリティの留意点

- フォーカス移動によりすべての主要操作にアクセスできます。折りたたみボタンやお気に入りトグルには`aria-*`属性を付与しています。
- EmptyStateや候補0件時メッセージは`aria-live="polite"`で読み上げ対象として設定されています。

## 5. トラブルシューティング

| 状況 | 対処 | 備考 |
| --- | --- | --- |
| 条件追加後にURLが更新されない | ブラウザの履歴APIが無効化されていないか確認 | ブラウザ拡張による制限が原因となる場合があります |
| クエリパラメータが長くなる | フィルタを整理し、不要な条件を削除 | 圧縮により一定程度抑制されますが、条件過多の場合は共有前に見直してください |
| アセン渡しボタンが無効のまま | メッセージに表示されたスロットの候補数を確認 | 各スロットのフィルタ条件を緩和するか、お気に入り解除を検討してください |

## 6. 関連ドキュメント

- `docs/specs/parts-list-view/requirements.md`: 仕様詳細
- `docs/specs/parts-list-view/design.md`: アーキテクチャ概要
- `docs/specs/parts-list-view/tasks.md`: 実装タスクの進捗管理

このガイドを参照することで、パーツ一覧ページの探索から組立ページへの受け渡しまで一貫した操作を実現できます。
