# アクション前宣言によるユーザーへの操作影響の明示

- ステータス: 提案中
- 日付: 2026-01-23
- タグ: ui, ux, i18n, mobile

技術ストーリー: [UI改善方針](../specs/ui-improvement/PLAN.md)

## 背景 / 文脈

現在のUIでは、ランダムアセンブルやパーツ探索などの操作ボタンに対して、操作名のラベルやツールチップは表示されるが、「その操作を実行すると何が起こるか」は明示されていない。

ユーザーは以下の不安を抱える可能性がある：

- 「ランダム」を押すと、今設定しているパーツが全部消えるのか？
- ロックしたパーツは本当に変更されないのか？
- パーツ探索は何を基準に探索するのか？

この不安が操作をためらわせ、ツールの活用度を下げている。

## 決定ドライバ

- **モバイルファースト**: メインユーザーはモバイル。モバイルでの表示性を最優先する
- **心理的安全性**: ユーザーが安心して操作できること
- **ロック機能の意味補強**: ロック機能が「操作から保護される」ことを暗黙ではなく明示する
- **操作テンポの維持**: 確認ダイアログの乱発による操作阻害を避ける
- **UIの沈黙**: メイン画面は静かに保ち、必要な場所でのみ情報を提示する
- **i18n対応**: 日本語・英語両方で適切なメッセージを提供する

## 検討した選択肢

1. ツールチップに操作影響を追記
2. 操作前に確認モーダルを表示（毎回）
3. ボタン直下に常時説明文を表示
4. 操作パネル内に説明文を配置
5. 初回のみ確認モーダル、以降省略
6. 何もしない（現状維持）

## 決定（採択）

選択したオプション: "4. 操作パネル内に説明文を配置"

### 対象アクションごとの方針

| アクション         | 方式                                             | 理由                                                                         |
| ------------------ | ------------------------------------------------ | ---------------------------------------------------------------------------- |
| ランダムアセンブル | 操作パネル（RandomAssemblyOffCanvas）内に説明文  | パネルを開く行為自体が意図的。パネル内で説明することで「沈黙するUI」を維持   |
| パーツ探索         | 保留（グローバルナビ導入時に検討）               | ナビゲーション構造の変更を伴うため、グローバルナビと併せて設計               |

### 採用理由

- **モバイル表示性**: 操作パネル内であれば確実に表示される
- **操作テンポ維持**: パネルを開く → 設定 → 実行 の流れの中で自然に目に入る
- **UIの沈黙維持**: メイン画面は静かなまま、操作モードに入った時点で説明を提示
- **実装コスト**: 既存のオフキャンバス構造を活用でき、低コスト

## 影響評価

- セキュリティ: 影響なし
- パフォーマンス: 影響なし
- ユーザー体験: 操作前の不安が軽減され、機能の活用度が向上する
- アクセシビリティ: 説明文は通常のテキストとして配置され、スクリーンリーダーでも自然に読み上げられる
- トレーサビリティ: 影響なし

### ポジティブな影響

- モバイルユーザーに確実に情報が届く
- ロック機能の意味が「操作パネルの説明」として自然に補強される
- 誤操作への恐れが減り、操作テンポが上がる
- メイン画面の「沈黙」が維持される

### ネガティブな影響 / トレードオフ

- パネルを開かないと説明が見えない（ただし、パネルを開かないと操作もできないため問題なし）
- 各アクションの表示方式が統一されない可能性（グローバルナビ導入時に再検討）

## 各選択肢の利点と欠点

### 1. ツールチップに操作影響を追記

- 良い点: 操作テンポを阻害しない
- 良い点: レイアウト変更が不要
- 良い点: 実装コストが低い
- 悪い点: **モバイルでの表示性が悪い（ホバーが使えない）**
- 悪い点: ツールチップを見ないユーザーには効果がない

### 2. 操作前に確認モーダルを表示（毎回）

- 良い点: 確実にユーザーの目に入る
- 良い点: 誤操作を確実に防げる
- 悪い点: 毎回の確認が煩わしく、操作テンポが著しく低下する
- 悪い点: 慣れたユーザーにとっては不要な障壁になる

### 3. ボタン直下に常時説明文を表示

- 良い点: 常に見える状態で情報提供できる
- 良い点: モバイルでも確実に表示される
- 悪い点: 画面を圧迫し、UIの「沈黙」という設計思想に反する可能性
- 中立: コンパクトに収めれば許容範囲（将来の選択肢として残す）

### 4. 操作パネル内に説明文を配置

- 良い点: モバイルでも確実に表示される
- 良い点: 操作テンポを阻害しない
- 良い点: メイン画面の「沈黙」を維持できる
- 良い点: 既存構造を活用でき、実装コストが低い
- 悪い点: パネルを開かないと説明が見えない

### 5. 初回のみ確認モーダル、以降省略

- 良い点: 初見ユーザーには確実に情報が届く
- 良い点: 慣れたユーザーの操作テンポを阻害しない
- 悪い点: 実装コストが高い（状態の永続化が必要）
- 悪い点: ブラウザ/デバイスを変えると再度表示される

### 6. 何もしない（現状維持）

- 良い点: 実装コストゼロ
- 悪い点: ユーザーの不安が解消されない
- 悪い点: ロック機能の意味が暗黙のままになる

## フォローアップ / 移行計画

### Phase 1: ランダムアセンブル（本ADRのスコープ）

1. i18nキーの追加
   - `random:panel.effect` → `ロックされていないパーツのみ変更されます`
   - 英語版: `Only unlocked parts will be changed`

2. RandomAssemblyOffCanvas の修正
   - パネル上部（タイトル下）に説明文を配置
   - 小さめのフォントサイズ、控えめな色で表示

### Phase 2: パーツ探索（グローバルナビ導入時）

- グローバルナビゲーションの設計と併せて検討
- 「ボタン直下に常時説明文」も選択肢として再評価

## 参考リンク

- [UI改善方針](../specs/ui-improvement/PLAN.md)
