# AGENTS.md

## 言語

- ドキュメント・回答・コメントなど、すべてのやり取りは日本語を使用する。

## 開発スタイルと優先度

- 以下の開発スタイルを重視する：
  - TDD（Test-Driven-Development）
  - UDD（UseCase-Driven-Development）、特にドキュメンテーション
  - DDD（Domain-Driven-Design）、特にドキュメンテーション、アプリ設計、ディレクトリ構成、クラス・関数・モジュールの命名
- 開発スタイルが衝突した場合は、**UDD > DDD > TDD** の優先度で判断する。

## 意思決定とADR

- 意思決定があった場合は、ADR（Architecture Decision Record）として必ず記録する。
- ADRは `docs/adr` に配置する。
- フォーマットは `docs/adr/template.md` に従う。
- **ファイル命名規則**：
  - 1つの意思決定につき1ファイルを作成する。
  - ファイル名は `docs/adr/YYYYMMDD-タイトル.md` の形式とする。
  - 日付は決定日を `YYYYMMDD` 形式で記録する。
  - タイトルは小文字ケバブケースで簡潔に記述する。
  - 同日に複数のADRを作る場合は連番を付与する。  
    （例：`20250924-adopt-monorepo-structure.md`, `20250924-02-introduce-tdd.md`）

## リポジトリ構成

- 本リポジトリは monorepo 構成とする。
- `packages/` 以下に各パッケージを配置する。
- パッケージの責務境界は以下とする：
  - アプリ本体
  - e2eテスト
  - 共通のツール設定（lint, formatter など）

## e2eテスト

- e2eテストは独立したパッケージとする。
- 他パッケージからの import を禁止する。
- 実行時は、アプリ本体をビルドし dev サーバーで起動、その外部利用を通じてテストを行う。

## 出力フォーマット

- 出力は **Markdown形式** とする。
- コードやdiffを提示する場合も、必ずMarkdownコードブロックで囲む。

## 曖昧要求への対応

- 曖昧または矛盾する要求に対しては、推測で対応せず、**確認を求める**こと。

## 用語の取り扱い

- プロジェクト固有の用語を導入する場合は、専用の用語集を作成すること。
- 用語集は `docs/terms.md` に配置する。
- ドキュメントやコメントで独自用語を使用する場合は、***太字斜体*** で装飾すること。
- 定義されていない用語を使う必要がある場合は、まず確認を求める。

## Issue / PR の作成ルール

- Issue を作成する際は、`.github/ISSUE_TEMPLATE/` にあるテンプレートに従うこと。
  - 機能追加・改修の場合は `feature.md`
  - バグ修正の場合は `bug.md`
- Pull Request を作成する際は、`.github/pull_request_template.md` に従うこと。
- テンプレートの各項目は空欄にせず、内容がない場合は「なし」と明記すること。
- 1 Issue = 1目的、1 PR = 1論点とする。

## セキュリティとコスト

- 不要な依存追加を禁止する。
- 規約に衝突がある場合は、**既存規約 > AGENTS.md > 一般慣習** の順で優先する。
- 出力や提案は、最小限の差分で可逆的（revert可能）であること。

## やらないことリスト

- 本番環境や本番データに対する操作を行わない。
- Secrets、APIキー、認証情報を生成・出力しない。
- 外部コードやライブラリを無断で追加しない。
- 規約に従わない独自ルールを持ち込まない。
- main ブランチへ直接 push しない。
- セキュリティやライセンスに関わる変更を独断で行わない。
